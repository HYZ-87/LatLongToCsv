using Microsoft.VisualStudio.TestTools.UnitTesting;
using PdfToXlsx;
using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace PdfToXlsx.Tests
{
    [TestClass()]
    public class Form1Tests
    {
        Form1 form = new Form1();
        [TestMethod()]
        public void GetChineseStringsTest()
        {
            string s = "高速公路-桃園2\r\n\r\n1212311.49, 250347.53;\r\n1212311.4, 250347.44;";//
            string[] expected = new string[] { "高速公路-桃園2", "1212311.49, 250347.53;\r\n1212311.4, 250347.44;" };

            CollectionAssert.AreEqual(expected, form.SeperateTitleAndData(s));
        }

        [TestMethod()]
        public void SeperateStringTest()
        {
            string s = "\"高速公路-桃園2\r\n\r\n1212311.49, 250347.53;\r\n1212311.4, 250347.44;\r\n1212311.38, 250347.42;\r\n1212310.97, 250347.04;\r\n1212310.89, 250346.98;\r\n1212310.82, 250346.93;\r\n1212310.74, 250346.88;\r\n1212310.66, 250346.84;\r\n1212310.57, 250346.81;\r\n1212310.48, 250346.79;\r\n1212310.39, 250346.77;\r\n1212310.3, 250346.76;\r\n1212310.21, 250346.75;\r\n1212310.11, 250346.76;\r\n1212310.02, 250346.77;\r\n1212309.93, 250346.79;\r\n1212309.84, 250346.81;\r\n1212309.75, 250346.84;\r\n1212309.67, 250346.88;\r\n1212309.59, 250346.93;\r\n1212309.52, 250346.98;\r\n1212309.45, 250347.04;\r\n1212309.39, 250347.1;\r\n1212309.35, 250347.14;\r\n1212309.18, 250347.34;\r\n1212309.3, 250347.33;\r\n1212309.61, 250347.44;\r\n1212309.81, 250347.58;\r\n1212310.14, 250347.7;\r\n1212310.55, 250347.76;\r\n1212311.04, 250347.77;\r\n1212311.48, 250347.55;\r\n1212311.49, 250347.53;\r\n\"\r\n\"" +
                "桃9-觀園風力發電站1號機\r\n\r\n1210955.8, 250440.8;\r\n1210957.56, 250440.89;\r\n1210959.31, 250441.15;\r\n1211001.03, 250441.58;\r\n1211002.69, 250442.17;\r\n1211004.29, 250442.93;\r\n1211005.8, 250443.83;\r\n1211007.22, 250444.89;\r\n1211008.53, 250446.07;\r\n1211009.71, 250447.38;\r\n1211010.77, 250448.8;\r\n1211011.67, 250450.31;\r\n1211012.43, 250451.91;\r\n1211013.02, 250453.57;\r\n1211013.45, 250455.29;\r\n1211013.71, 250457.04;\r\n1211013.8, 250458.8;\r\n1211013.71, 250500.56;\r\n1211013.45, 250502.31;\r\n1211013.02, 250504.03;\r\n1211012.43, 250505.69;\r\n1211011.67, 250507.29;\r\n1211010.77, 250508.8;\r\n1211009.71, 250510.22;\r\n1211008.53, 250511.53;\r\n1211007.22, 250512.71;\r\n1211005.8, 250513.77;\r\n1211004.29, 250514.67;\r\n1211002.69, 250515.43;\r\n1211001.03, 250516.02;\r\n1210959.31, 250516.45;\r\n1210957.56, 250516.71;\r\n1210955.8, 250516.8;\r\n1210954.04, 250516.71;\r\n1210952.29, 250516.45;\r\n1210950.57, 250516.02;\r\n1210948.91, 250515.43;\r\n1210947.31, 250514.67;\r\n1210945.8, 250513.77;\r\n1210944.38, 250512.71;\r\n1210943.07, 250511.53;\r\n1210941.89, 250510.22;\r\n1210940.83, 250508.8;\r\n1210939.93, 250507.29;\r\n1210939.17, 250505.69;\r\n1210938.58, 250504.03;\r\n1210938.15, 250502.31;\r\n1210937.89, 250500.56;\r\n1210937.8, 250458.8;\r\n1210937.89, 250457.04;\r\n1210938.15, 250455.29;\r\n1210938.58, 250453.57;\r\n1210939.17, 250451.91;\r\n1210939.93, 250450.31;\r\n1210940.83, 250448.8;\r\n1210941.89, 250447.38;\r\n1210943.07, 250446.07;\r\n1210944.38, 250444.89;\r\n1210945.8, 250443.83;\r\n1210947.31, 250442.93;\r\n1210948.91, 250442.17;\r\n1210950.57, 250441.58;\r\n1210952.29, 250441.15;\r\n1210954.04, 250440.89;\r\n1210955.8, 250440.8;\r\n\"\r\n";
            string[] expected = new string[] { "高速公路-桃園2\r\n\r\n1212311.49, 250347.53;\r\n1212311.4, 250347.44;\r\n1212311.38, 250347.42;\r\n1212310.97, 250347.04;\r\n1212310.89, 250346.98;\r\n1212310.82, 250346.93;\r\n1212310.74, 250346.88;\r\n1212310.66, 250346.84;\r\n1212310.57, 250346.81;\r\n1212310.48, 250346.79;\r\n1212310.39, 250346.77;\r\n1212310.3, 250346.76;\r\n1212310.21, 250346.75;\r\n1212310.11, 250346.76;\r\n1212310.02, 250346.77;\r\n1212309.93, 250346.79;\r\n1212309.84, 250346.81;\r\n1212309.75, 250346.84;\r\n1212309.67, 250346.88;\r\n1212309.59, 250346.93;\r\n1212309.52, 250346.98;\r\n1212309.45, 250347.04;\r\n1212309.39, 250347.1;\r\n1212309.35, 250347.14;\r\n1212309.18, 250347.34;\r\n1212309.3, 250347.33;\r\n1212309.61, 250347.44;\r\n1212309.81, 250347.58;\r\n1212310.14, 250347.7;\r\n1212310.55, 250347.76;\r\n1212311.04, 250347.77;\r\n1212311.48, 250347.55;\r\n1212311.49, 250347.53;\r\n",
                "桃9-觀園風力發電站1號機\r\n\r\n1210955.8, 250440.8;\r\n1210957.56, 250440.89;\r\n1210959.31, 250441.15;\r\n1211001.03, 250441.58;\r\n1211002.69, 250442.17;\r\n1211004.29, 250442.93;\r\n1211005.8, 250443.83;\r\n1211007.22, 250444.89;\r\n1211008.53, 250446.07;\r\n1211009.71, 250447.38;\r\n1211010.77, 250448.8;\r\n1211011.67, 250450.31;\r\n1211012.43, 250451.91;\r\n1211013.02, 250453.57;\r\n1211013.45, 250455.29;\r\n1211013.71, 250457.04;\r\n1211013.8, 250458.8;\r\n1211013.71, 250500.56;\r\n1211013.45, 250502.31;\r\n1211013.02, 250504.03;\r\n1211012.43, 250505.69;\r\n1211011.67, 250507.29;\r\n1211010.77, 250508.8;\r\n1211009.71, 250510.22;\r\n1211008.53, 250511.53;\r\n1211007.22, 250512.71;\r\n1211005.8, 250513.77;\r\n1211004.29, 250514.67;\r\n1211002.69, 250515.43;\r\n1211001.03, 250516.02;\r\n1210959.31, 250516.45;\r\n1210957.56, 250516.71;\r\n1210955.8, 250516.8;\r\n1210954.04, 250516.71;\r\n1210952.29, 250516.45;\r\n1210950.57, 250516.02;\r\n1210948.91, 250515.43;\r\n1210947.31, 250514.67;\r\n1210945.8, 250513.77;\r\n1210944.38, 250512.71;\r\n1210943.07, 250511.53;\r\n1210941.89, 250510.22;\r\n1210940.83, 250508.8;\r\n1210939.93, 250507.29;\r\n1210939.17, 250505.69;\r\n1210938.58, 250504.03;\r\n1210938.15, 250502.31;\r\n1210937.89, 250500.56;\r\n1210937.8, 250458.8;\r\n1210937.89, 250457.04;\r\n1210938.15, 250455.29;\r\n1210938.58, 250453.57;\r\n1210939.17, 250451.91;\r\n1210939.93, 250450.31;\r\n1210940.83, 250448.8;\r\n1210941.89, 250447.38;\r\n1210943.07, 250446.07;\r\n1210944.38, 250444.89;\r\n1210945.8, 250443.83;\r\n1210947.31, 250442.93;\r\n1210948.91, 250442.17;\r\n1210950.57, 250441.58;\r\n1210952.29, 250441.15;\r\n1210954.04, 250440.89;\r\n1210955.8, 250440.8;" };

            string[] ss = form.SeperateString(s);
            CollectionAssert.AreEqual(expected, ss);
        }

        [TestMethod()]
        public void TestTest()
        {
            //string s = "\"中 417 隧道入口 \r\n順序連接下列各點所含之區域： \r\n1203659, 241253; \"\r\n\"1203700, 241253; \r\n1203700, 241251; \r\n1203658, 241252; \r\n1203659, 241253; \"";
            //string expected = "\"中 417 隧道入口 \r\n順序連接下列各點所含之區域： \r\n1203659, 241253;\r\n1203700, 241253; \r\n1203700, 241251; \r\n1203658, 241252; \r\n1203659, 241253; \"";
            string s = "\"\r\n\"123456, 123;\"\r\n\"123456, 123;";
            string expected = "123456, 123;123456, 123;";

            Assert.AreEqual(expected, form.Test(s));
        }
    }
}